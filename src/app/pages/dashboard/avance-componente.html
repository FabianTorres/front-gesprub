<div class="card">
    <div class="flex justify-between items-center mb-4 flex-wrap gap-2">
        <h2 class="text-2xl font-semibold m-0">Avance por Componente</h2>

        <div class="flex items-center gap-2">
        <div *ngIf="ambitos().length > 0">
                <p-select [options]="ambitos()"
                            [ngModel]="ambitoSeleccionadoId()"
                            (ngModelChange)="ambitoSeleccionadoId.set($event)"
                            optionLabel="nombre_ambito"
                            optionValue="id_ambito"
                            placeholder="Filtrar por Ámbito..."
                            [showClear]="true"
                            styleClass="w-full md:w-15rem">
                </p-select>
            </div>
        
        <div *ngIf="hitos().length > 0">
            <p-select [options]="hitos()"
                      [(ngModel)]="hitoSeleccionado"
                      (ngModelChange)="hitoSeleccionado.set($event)"
                      optionLabel="nombre"
                      optionValue="id"
                      placeholder="Filtrar por Hito..."
                      [showClear]="true"
                      styleClass="w-full md:w-15rem">
            </p-select>
        </div>
        </div>
    </div>

    <div *ngIf="cargando()" class="text-center p-4">
        <i class="pi pi-spin pi-spinner" style="font-size: 2rem"></i>
        <p class="mt-2">Cargando datos del reporte...</p>
    </div>

    <div *ngIf="!cargando() && !chartData">
        <p class="text-center text-lg text-surface-500">No hay datos de avance para mostrar.</p>
    </div>
    
    <div *ngIf="!cargando() && chartData" class="chart-container" style="position: relative; height: 60vh;">
        <p-chart type="bar" [data]="chartData" [options]="chartOptions"></p-chart>
    </div>

    <div *ngIf="totalRecords() > pageSize" class="mt-4">
        <p-paginator (onPageChange)="onPageChange($event)" 
                     [rows]="pageSize" 
                     [totalRecords]="totalRecords()">
        </p-paginator>
    </div>
</div>